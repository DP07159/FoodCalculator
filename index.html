<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">

        <!-- üåü Header mit Logo (kommt sp√§ter) -->
        <header>
            <h1>Food Calculator</h1>
        </header>

        <!-- üåü Wochenplan -->
        <section id="meal-plan">
            <h2>Wochenplan</h2>
            <p id="current-plan-name" class="left-align">Kein Plan geladen</p>
            <table>
                <thead>
                    <tr>
                        <th>Tag</th>
                        <th>Fr√ºhst√ºck</th>
                        <th>Mittagessen</th>
                        <th>Abendessen</th>
                        <th>Snack</th>
                        <th>Gesamtkalorien</th>
                        <th>Restkalorien</th>
                    </tr>
                </thead>
                <tbody id="meal-table"></tbody>
            </table>
        </section>

        <div class="plan-and-recipe-container">
    <!-- üåü Neuen Plan anlegen -->
    <section id="add-plan">
        <p class="small-title">Neuen Plan anlegen</p>
        <div class="plan-input-wrapper">
            <input type="text" id="plan-name" placeholder="Name f√ºr neuen Plan">
            <button onclick="saveMealPlan()">Speichern</button>
        </div>

        <!-- üåü Pl√§ne verwalten -->
        <div id="plan-management">
            <p class="small-title">Pl√§ne verwalten</p>
            <div class="plan-controls">
                <select id="plan-list"></select>
                <button onclick="loadMealPlan()">Laden</button>
                <button onclick="updateMealPlan()">Aktualisieren</button>
                <button class="icon-button" onclick="deleteMealPlan()">üóëÔ∏è</button>
            </div>
        </div>
    </section>

    <!-- üåü Rezept hinzuf√ºgen -->
    <section id="add-recipe">
        <p class="small-title">Rezept hinzuf√ºgen</p>
        <div class="recipe-inputs">
            <input type="text" id="recipe-name" placeholder="Rezeptname">
            <input type="number" id="recipe-calories" placeholder="Kalorien">
        </div>
        <div class="recipe-checkboxes">
            <label><input type="checkbox" value="breakfast"> Fr√ºhst√ºck</label>
            <label><input type="checkbox" value="lunch"> Mittagessen</label>
            <label><input type="checkbox" value="dinner"> Abendessen</label>
            <label><input type="checkbox" value="snack"> Snack</label>
        </div>
        <button onclick="addRecipe()">Rezept hinzuf√ºgen</button>
    </section>
</div>

    <!-- üåü Rezeptbuch -->
    <section id="recipe-book">
        <h2>Rezeptbuch</h2>
        <ul id="recipe-list">
    <!-- Rezepte werden hier dynamisch eingef√ºgt -->
</ul>

<script>
    async function loadRecipes() {
    try {
        const response = await fetch('/recipes');
        const responseText = await response.text();  // Rohtext anzeigen

        console.log("üîé Server Response (Rezeptdaten):", responseText); // ‚Üê Das ist der Schl√ºssel!

        if (responseText.trim().startsWith('{') || responseText.trim().startsWith('[')) {
            const recipes = JSON.parse(responseText);
            console.log("‚úÖ Erfolgreiches JSON-Parsing:", recipes);

            const recipeList = document.getElementById('recipe-list');
            recipeList.innerHTML = '';

            recipes.forEach(recipe => {
                const listItem = document.createElement('li');
                listItem.classList.add('recipe-item');
                listItem.setAttribute('data-id', recipe.id);

                listItem.innerHTML = `<a href="/recipeDetails.html?id=${recipe.id}" class="recipe-link">
                                        ${recipe.name}
                                     </a>`;
                recipeList.appendChild(listItem);
            });
        } 

    } catch (error) {
        console.error("‚ùå Fehler beim Laden der Rezepte:", error.message);
        alert('Fehler beim Laden der Rezepte. Siehe Konsole f√ºr Details.');
    }
}

window.onload = loadRecipes;
</script>

    </section>
</div>


    </div>

    <script src="script.js"></script>
</body>
</html>
